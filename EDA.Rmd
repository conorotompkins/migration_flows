---
title: "EDA"
author: "Conor Tompkins"
date: "5/15/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      message = FALSE,
                      warning = FALSE)
```

```{r}
library(tidyverse)
library(lubridate)
library(janitor)
library(tidytext)
library(hrbrthemes)

theme_set(theme_bw())
```

```{r}
df <- read_csv("output/migration_data_cleaned.csv") %>% 
  filter(year == 2018)

df
```


```{r}
df <- df %>% 
  select(state_from, state_to, migration)

df
```

```{r}
df_states <- df %>% 
  select(state_from, state_to, migration) %>% 
  filter(state_from != state_to) %>%
  arrange(state_from, state_to)

df_states
```

```{r}
df_states %>% 
  filter(state_from %in% c("Pennsylvania", "New York", "Ohio", "Virginia", "West Virginia", "Maryland")) %>%
  mutate(state_to = reorder_within(state_to, migration, state_from)) %>%
  arrange(state_from, desc(migration)) %>% 
  group_by(state_from) %>% 
  slice(1:5) %>% 
  ggplot(aes(migration, state_to)) +
    geom_col() +
    facet_wrap(~state_from, scales = "free") +
    scale_y_reordered() +
    scale_x_comma()
```


```{r}
df_states %>% 
  group_by(state_to) %>% 
  summarize(migration = sum(migration, na.rm = TRUE)) %>% 
  ungroup() %>% 
  arrange(desc(migration)) %>% 
  mutate(state_to = fct_reorder(state_to, migration)) %>%
  ggplot(aes(migration, state_to)) +
    geom_col()
```
